# 1. Activar el motor de reescritura
RewriteEngine On

# 2. Forzar HTTPS y www
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} ^pulcast\.com$ [NC]
RewriteRule ^(.*)$ https://www.pulcast.com/$1 [L,R=301]

# 3. Evitar listado de directorios
Options -Indexes

# 4. Seguridad básica: bloquear archivos peligrosos
<FilesMatch "\.(htaccess|env|ini|log|sh|sql|bak|zip|rar)$">
  Order allow,deny
  Deny from all
</FilesMatch>

# 5. Protección contra inyecciones SQL y XSS básicas
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} union.*select.*\([0-9]*\) [NC,OR]
RewriteCond %{QUERY_STRING} concat.*\(.*\) [NC,OR]
RewriteCond %{QUERY_STRING} [\'\"] [NC,OR]
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [NC]
RewriteRule .* - [F]

# 6. Bloqueo de bots maliciosos comunes
BrowserMatchNoCase "AhrefsBot" bad_bot
BrowserMatchNoCase "SemrushBot" bad_bot
BrowserMatchNoCase "MJ12bot" bad_bot
BrowserMatchNoCase "DotBot" bad_bot
Order Allow,Deny
Allow from all
Deny from env=bad_bot

# 7. Cabeceras de seguridad
<IfModule mod_headers.c>
  Header set X-Frame-Options "SAMEORIGIN"
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Content-Type-Options "nosniff"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# 8. Compresión gzip (si tu hosting lo soporta)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/css text/javascript application/javascript application/json
</IfModule>

# 9. Cacheo de recursos estáticos
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresDefault "access plus 1 week"
</IfModule>

# 10. Página de error personalizada
ErrorDocument 404 /Vista/Paginas/404.php
ErrorDocument 403 /Vista/Paginas/403.php
